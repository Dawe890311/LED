# LED植物照明光学度量体系分析软件说明文档

## 📋 软件概述

### 软件名称
LED植物照明光学度量体系分析系统

### 软件版本
v1.0

### 开发目的
本软件基于植物照明光学度量体系理论，为LED植物灯的光谱性能提供科学、准确的量化分析。软件集成了四种光学度量体系，包括辐射度学、光度学、光子度量学和植物光子度量学，能够全面评估LED植物灯的光效性能。

### 理论基础
- 基于McCree (1972)植物光合敏感曲线P(λ)
- 遵循国际植物照明标准
- 集成四种光学度量体系的完整理论框架
- 参考最新植物照明光学度量体系研究成果

## 🔧 软件功能

### 主要功能
1. **光谱数据分析**: 支持CSV/TXT/Excel格式的光谱数据文件
2. **多维度光效计算**: 基于四种光学度量体系的全面分析
3. **可视化展示**: 彩虹光谱图、植物光合敏感曲线对比等
4. **智能评价系统**: 基于科学标准的等级评价
5. **专业报告生成**: 详细的分析结果和建议

### 输入参数
- **总辐射通量** (W): LED灯具的总辐射功率输出
- **总功率** (W): LED灯具的电功率消耗
- **后面板温度** (℃): LED灯具后面板工作温度
- **功率因数**: 电功率因数，无量纲
- **光谱数据文件**: 包含波长(nm)和对应辐射强度的数据文件

## 📊 四种光学度量体系

### 1. 辐射度学 (Radiometry)
**定义**: 基于能量评价的光学度量体系，研究辐射源发射的能量或受体接收的能量。

**核心参数**:
- 辐射通量 Φₑ (W)
- 辐照度 Eₑ (W/m²)

**适用场景**: 能量评价、热分析

### 2. 光度学 (Photometry)
**定义**: 基于人眼视觉响应的光学度量体系，考虑人眼对不同波长光的敏感度。

**核心参数**:
- 光通量 Φ (lm)
- 照度 E (lx)
- 基于人眼视见函数 V(λ)

**适用场景**: 人因照明、视觉舒适度评价

### 3. 光子度量学 (Photon Metrics)
**定义**: 基于光子数量的光学度量体系，以光子摩尔数为单位进行计算。

**核心参数**:
- 光子通量 Φₚ (μmol/s)
- 光子通量密度 Eₚ (μmol/m²/s)
- PPF/PPFD (400-700nm)

**适用场景**: 植物照明标准评价

### 4. 植物光子度量学 (Plant Photon Metrics)
**定义**: 基于植物光合敏感曲线P(λ)的光学度量体系，更准确评估光源对植物的有效性。

**核心参数**:
- 植物光子通量 Φₚₚ (μmol/s)
- 基于McCree (1972)植物光合敏感曲线

**适用场景**: 精准植物照明、科研应用

## 🧮 详细计算公式

### 基础常数和数据

#### 光子能量转换常数
```
γ = NAhc = 119.8 W·s·nm·μmol⁻¹
```
其中：
- NA = 阿伏加德罗常数 (6.022 × 10²³ mol⁻¹)
- h = 普朗克常数 (6.63 × 10⁻³⁴ J·s)
- c = 光速 (3 × 10⁸ m/s)

#### 输入数据定义
- **λ** = 波长 (nm) - 数据文件第一列
- **Φₑ(λ)** = 对应波长的辐射强度 - 数据文件第二列

### 核心积分计算

#### 1. 积分值计算
每个波长点的积分值（用于光合有效计算）：
```
积分值(λ) = λ × Φₑ(λ) / 119.8
```

#### 2. 光合有效积分
对所有波长的积分值求和：
```
光合有效积分 = Σ [λ × Φₑ(λ) / 119.8]
```
**含义**: 表征光源产生光合有效光子的总量，单位为μmol等效。

#### 3. 总积分
对所有辐射值直接求和：
```
总积分 = Σ Φₑ(λ)
```
**含义**: 光源的总辐射能量积分，反映光源的总能量输出。

#### 4. PAR积分
400-700nm波长范围内的辐射值直接求和：
```
PAR积分 = Σ₄₀₀⁷⁰⁰ Φₑ(λ)
```
**含义**: 光合有效辐射范围内的总能量，植物光合作用的有效能量。

#### 5. 各波段积分
基于积分值的分段求和：

**蓝光积分 (400-500nm，不含500)**：
```
蓝光积分 = Σ₄₀₀⁴⁹⁹ [λ × Φₑ(λ) / 119.8]
```
**含义**: 蓝光波段的光子积分，影响植物叶绿素合成和形态发育。

**绿光积分 (500-600nm，不含600)**：
```
绿光积分 = Σ₅₀₀⁵⁹⁹ [λ × Φₑ(λ) / 119.8]
```
**含义**: 绿光波段的光子积分，影响植物光合作用效率和叶片发育。

**红光积分 (600-700nm，不含700)**：
```
红光积分 = Σ₆₀₀⁶⁹⁹ [λ × Φₑ(λ) / 119.8]
```
**含义**: 红光波段的光子积分，是植物光合作用的主要驱动力。

**远红光积分 (700-800nm，不含800)**：
```
远红光积分 = Σ₇₀₀⁷⁹⁹ [λ × Φₑ(λ) / 119.8]
```
**含义**: 远红光波段的光子积分，影响植物光周期响应和茎伸长。

#### 6. 灯具光质总和积分
```
光质总和积分 = 蓝光积分 + 绿光积分 + 红光积分 + 远红光积分
```
**含义**: 各颜色光积分的总和，用于计算光质分布比例。

### 效率与比例参数

#### 7. PPF效能
```
PPF效能 = 光合有效积分 / 总积分 (μmol/J)
```
**含义**: 光源产生光合有效光子的效率，数值越高表示光合有效光子产出越高。

**评价标准**:
- 优秀: > 2.5 μmol/J
- 良好: 2.0-2.5 μmol/J
- 一般: < 2.0 μmol/J

#### 8. PAR效率
```
PAR效率 = PAR积分 / 总积分
```
**含义**: 光合有效辐射占总辐射的比例，反映光源在PAR波段的能量集中度。

**评价标准**:
- 优秀: > 80%
- 良好: 60-80%
- 一般: < 60%

#### 9. 光质占比
```
蓝光占比 = 蓝光积分 / 光质总和积分 × 100%
绿光占比 = 绿光积分 / 光质总和积分 × 100%
红光占比 = 红光积分 / 光质总和积分 × 100%
远红光占比 = 远红光积分 / 光质总和积分 × 100%
```
**含义**: 各波段光子在总光质中的比例，用于分析光谱组成。

#### 10. 光质比例指标

**R/B比值**:
```
R/B = 红光积分 / 蓝光积分
```
**含义**: 红蓝光比例，影响植物形态建成和次生代谢。

**适宜范围**:
- 叶菜类: 0.5-1.5
- 果菜类: 1.0-3.0

**R/Fr比值**:
```
R/Fr = 红光积分 / 远红光积分
```
**含义**: 红光与远红光比例，影响植物光周期响应和茎伸长。

### 性能指标

#### 11. PPF (光合光子通量)
```
PPF = 总辐射通量 × PPF效能 (μmol/s)
```
**含义**: 光源发出的光合有效光子通量，衡量光源的实际光合效能输出。

#### 12. PAR功率
```
PAR功率 = 总辐射通量 × PAR效率 (W)
```
**含义**: PAR波段的实际功率输出，反映有效辐射功率。

#### 13. PFE (光合光子效率)
```
PFE = PPF / 总功率 (μmol/J)
```
**含义**: 单位电功率产生的光合有效光子数，衡量光源的能效。

#### 14. 光效 (辐射光效)
```
光效 = 总辐射通量 / 总功率 (W/W)
```
**含义**: 电功率转换为辐射功率的效率，反映光源的基本能效。

### 植物光子度量学

#### 15. 植物光合敏感曲线 P(λ) (McCree 1972)
基于McCree在1972年测量的22种植物光合响应光谱均值：

**蓝光区域 (λ ≤ 550nm)**:
```
P(λ) = exp(-0.5 × ((λ-430)/40)²) × 0.8 + exp(-0.5 × ((λ-470)/30)²) × 0.6
```

**红光区域 (λ > 550nm)**:
```
P(λ) = exp(-0.5 × ((λ-630)/35)²) × 0.9 + exp(-0.5 × ((λ-670)/25)²) × 0.7
```

**特征**:
- 峰值位于430nm（蓝光）和630nm、670nm（红光）
- 反映植物光合系统对不同波长光的响应程度

#### 16. 植物加权积分
```
植物加权积分 = Σ [积分值(λ) × P(λ)]
```
**含义**: 基于植物光合敏感曲线加权的积分值，更准确反映对植物的有效性。

#### 17. 植物光子效能
```
植物光子效能 = 植物加权积分 / 总积分
```
**含义**: 考虑植物光合响应特性的光子产生效率，比PPF效能更精确。

## 📈 综合评价体系

### 评价算法
```python
def evaluate_light_quality(ppf_efficiency, par_efficiency, r_b_ratio):
    # PPF效能评分
    ppf_score = 3 if ppf_efficiency > 2.5 else 2 if ppf_efficiency > 2.0 else 1
    
    # PAR效率评分
    par_score = 3 if par_efficiency > 0.8 else 2 if par_efficiency > 0.6 else 1
    
    # R/B比值评分
    rb_score = 3 if 0.5 <= r_b_ratio <= 3.0 else 2 if 0.3 <= r_b_ratio <= 4.0 else 1
    
    # 综合评分
    total_score = ppf_score + par_score + rb_score
    
    if total_score >= 8:
        return "优秀"
    elif total_score >= 6:
        return "良好"
    else:
        return "一般"
```

### 评价维度
1. **光效评价**: 基于PPF效能和PFE
2. **光质评价**: 基于PAR效率和光谱分布
3. **能效评价**: 基于总功率和光效

## 🔄 计算流程

### 数据处理流程
1. **数据预处理**
   - 清理NaN值和无效数据
   - 确保波长和辐射数据类型正确
   - 数据范围验证

2. **基础计算**
   - 计算每个波长点的积分值
   - 计算光合有效积分和总积分
   - 计算PAR积分

3. **波段分析**
   - 计算各颜色光波段积分
   - 计算光质总和积分
   - 计算光质分布比例

4. **效率计算**
   - 计算PPF效能和PAR效率
   - 计算各种比例指标
   - 计算性能参数

5. **植物度量学**
   - 应用植物光合敏感曲线
   - 计算植物加权参数
   - 生成对比分析

6. **综合评价**
   - 多维度评价计算
   - 等级评定
   - 建议生成

## 📋 使用说明

### 数据文件格式要求
- **支持格式**: CSV、TXT、Excel (.xlsx, .xls)
- **数据结构**: 两列数据
  - 第一列: 波长 λ (nm)
  - 第二列: 对应波长的辐射强度
- **数据范围**: 建议覆盖300-800nm范围
- **数据精度**: 波长间隔建议1-5nm

### 输入参数建议
- **总辐射通量**: 根据实际测量值输入
- **总功率**: LED灯具的额定功率或实测功率
- **后面板温度**: 稳定工作状态下的温度
- **功率因数**: 通常在0.85-0.95之间

### 结果解读
1. **关注核心指标**: PPF效能、PAR效率、R/B比
2. **参考评价等级**: 优秀>良好>一般
3. **考虑应用场景**: 不同植物类型的适宜参数范围
4. **综合分析**: 结合多个指标进行全面评价

## 🔬 科学依据

### 理论基础
- McCree, K.J. (1972). The action spectrum, absorptance and quantum yield of photosynthesis in crop plants
- 国际照明委员会(CIE)植物照明标准
- 植物照明光学度量体系优化理论

### 应用价值
- 为LED植物灯设计提供科学依据
- 优化植物照明系统的光谱配置
- 提高植物照明的能效和效果
- 支持植物工厂和设施农业发展

## 🛠️ 技术规格

### 软件环境
- **开发语言**: Python
- **核心库**: Streamlit, Pandas, NumPy, Plotly
- **运行环境**: Python 3.7+
- **浏览器支持**: Chrome, Firefox, Safari, Edge

### 性能特点
- **计算精度**: 基于IEEE浮点标准
- **数据处理**: 支持大数据量光谱文件
- **实时计算**: 即时显示分析结果
- **可视化**: 交互式图表和专业报告

## 📞 技术支持

### 常见问题
1. **Q: 如何选择合适的波长范围？**
   A: 建议使用300-800nm范围，确保覆盖紫外、可见光和近红外区域。

2. **Q: PPF效能数值偏低怎么办？**
   A: 检查光谱是否集中在400-700nm PAR范围，优化红蓝光比例。

3. **Q: 数据文件读取失败？**
   A: 确认文件格式正确，检查是否包含标题行，数据列是否为数值类型。

### 更新日志
- **v1.0**: 初始版本，包含完整的四种光学度量体系
- 支持多格式数据文件导入
- 集成植物光合敏感曲线分析
- 提供综合评价体系

---

*本软件基于最新的植物照明科学研究成果开发，为LED植物照明行业提供专业的分析工具。*